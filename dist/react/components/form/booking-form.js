"use client";
import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import React from "react";
import { useForm } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";
import { EventMetaPanel } from "../calendar/event-meta-panel";
import { bookingFormSchema, } from "../../utils/validation";
import { formatDate, formatTimeDisplay } from "../../utils/formatting";
export const BookingForm = ({ eventType, selectedSlot, selectedDuration, timezone, onSubmit, onBack, isSubmitting, currentUser, isRescheduling = false, }) => {
    // Check if user has prefilled data
    const isPrefilled = !!(currentUser?.name || currentUser?.email);
    const { register, handleSubmit, formState: { errors }, } = useForm({
        resolver: zodResolver(bookingFormSchema),
        defaultValues: {
            name: currentUser?.name ?? "",
            email: currentUser?.email ?? "",
            phone: "",
            notes: "",
        },
    });
    const submitHandler = async (data) => {
        await onSubmit(data);
    };
    return (_jsxs("div", { className: "flex flex-col md:flex-row h-full", children: [_jsx(EventMetaPanel, { eventType: eventType, selectedDuration: selectedDuration, onDurationChange: () => { }, userTimezone: timezone, onTimezoneChange: () => { }, timezoneLocked: true, readOnly: true }), _jsxs("div", { className: "flex-1 p-6", children: [_jsxs("div", { className: "mb-6", children: [_jsx("h2", { className: "text-xl font-semibold text-foreground", children: isRescheduling ? "Confirm Reschedule" : "Enter Details" }), _jsxs("p", { className: "text-sm text-muted-foreground mt-1", children: [isRescheduling ? "New time: " : "", formatDate(selectedSlot, timezone), " at", " ", formatTimeDisplay(selectedSlot, "12h", timezone)] })] }), isPrefilled && (_jsxs("div", { className: "flex items-center gap-3 mb-6 p-3 rounded-lg bg-muted/50 border border-border", children: [currentUser?.avatarUrl ? (_jsx("img", { src: currentUser.avatarUrl, alt: currentUser.name ?? "User", className: "w-10 h-10 rounded-full object-cover" })) : (_jsx("div", { className: "w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center text-primary font-medium", children: (currentUser?.name ?? currentUser?.email ?? "U")[0].toUpperCase() })), _jsxs("div", { className: "flex-1", children: [_jsxs("p", { className: "text-sm font-medium text-foreground", children: ["Booking as ", currentUser?.name ?? currentUser?.email] }), currentUser?.email && currentUser?.name && (_jsx("p", { className: "text-xs text-muted-foreground", children: currentUser.email }))] })] })), _jsxs("form", { onSubmit: handleSubmit(submitHandler), className: "space-y-4", children: [_jsxs("div", { className: "space-y-2", children: [_jsx("label", { className: "text-sm font-medium text-foreground", children: "Name *" }), _jsx("input", { ...register("name"), placeholder: "John Doe", className: "w-full px-3 py-2 rounded-md border border-border bg-muted text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:border-ring" }), errors.name && (_jsx("p", { className: "text-sm text-destructive", children: errors.name.message }))] }), _jsxs("div", { className: "space-y-2", children: [_jsx("label", { className: "text-sm font-medium text-foreground", children: "Email *" }), _jsx("input", { ...register("email"), type: "email", placeholder: "john@example.com", readOnly: !!currentUser?.email, className: `w-full px-3 py-2 rounded-md border border-border text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:border-ring ${currentUser?.email
                                            ? "bg-muted/50 cursor-not-allowed opacity-75"
                                            : "bg-muted"}` }), errors.email && (_jsx("p", { className: "text-sm text-destructive", children: errors.email.message }))] }), _jsxs("div", { className: "space-y-2", children: [_jsx("label", { className: "text-sm font-medium text-foreground", children: "Phone Number" }), _jsx("input", { ...register("phone"), type: "tel", placeholder: "+1 (555) 000-0000", className: "w-full px-3 py-2 rounded-md border border-border bg-muted text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:border-ring" }), errors.phone && (_jsx("p", { className: "text-sm text-destructive", children: errors.phone.message }))] }), _jsxs("div", { className: "space-y-2", children: [_jsx("label", { className: "text-sm font-medium text-foreground", children: "Additional Notes" }), _jsx("textarea", { ...register("notes"), placeholder: "Please share anything that will help prepare for our meeting.", rows: 4, className: "w-full px-3 py-2 rounded-md border border-border bg-muted text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:border-ring resize-none" }), errors.notes && (_jsx("p", { className: "text-sm text-destructive", children: errors.notes.message }))] }), _jsxs("div", { className: "flex gap-3 pt-4", children: [_jsx("button", { type: "button", onClick: onBack, className: "flex-1 px-4 py-2 rounded-md border border-border bg-transparent text-muted-foreground font-medium hover:bg-muted hover:text-foreground transition-colors", children: "Back" }), _jsx("button", { type: "submit", disabled: isSubmitting, className: "flex-1 px-4 py-2 rounded-md bg-primary text-primary-foreground font-medium hover:bg-primary/90 disabled:opacity-50 disabled:cursor-not-allowed transition-colors", children: isSubmitting ? (_jsxs("span", { className: "flex items-center justify-center", children: [_jsxs("svg", { className: "animate-spin -ml-1 mr-2 h-4 w-4", fill: "none", viewBox: "0 0 24 24", children: [_jsx("circle", { className: "opacity-25", cx: "12", cy: "12", r: "10", stroke: "currentColor", strokeWidth: "4" }), _jsx("path", { className: "opacity-75", fill: "currentColor", d: "M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" })] }), isRescheduling ? "Rescheduling..." : "Confirming..."] })) : (isRescheduling ? "Confirm Reschedule" : "Confirm Booking") })] })] })] })] }));
};
//# sourceMappingURL=booking-form.js.map